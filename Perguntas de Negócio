Consultas que respondam perguntas de négocio:

1-
SELECT U.id_usuario, U.nome_usuario, COUNT(T.id_transacao) AS TotalTransacoes
FROM Usuario U
INNER JOIN Conta C ON U.id_usuario = C.usuario_id
INNER JOIN Transacao T ON C.num_conta = T.num_conta
WHERE T.dt_hr_transacao >= DATE_SUB(NOW(), INTERVAL 1 YEAR)
GROUP BY U.id_usuario, U.nome_usuario
ORDER BY TotalTransacoes DESC;

Interessante dessa consulta seria o DATE_SUB(NOW(), INTERVAL 1 YEAR), ele subtrai 1 ano da data atual (NOW()) resultando em uma data que representa exatamente um ano atrás a partir do momento atual.
