CREATE FUNCTION gerarExtrato(@ID_USUARIO INT)
RETURNS DECIMAL(18,2)
AS
BEGIN
  SELECT CONTA.NUM_CONTA,
         CONTA.SALDO
  FROM USUARIO
  INNER JOIN CONTA ON (CONTA.USUARIO_ID = USUARIO.ID_USUARIO)
  INNER JOIN HISTORICOTRANSACOES ON (HISTORICOTRANSACOES.NUM_CONTA = CONTA.NUM_CONTA)
  INNER JOIN TRANSACAO ON (TRANSACAO.ID_TRANSACAO = HISTORICOTRANSACOES.ID_TRANSACAO)
  WHERE USUARIO.ID_USUARIO = @ID_USUARIO

  RETURN HISTORICOTRANSACOES
END
